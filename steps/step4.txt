================================================================
CHECKLIT – PODSUMOWANIE ETAP 4: REKALIBRACJA NA CZYSTYM KORPUSIE
================================================================
Data: luty 2026

----------------------------------------------------------------
PROBLEM WYKRYTY W ETAPIE 3
----------------------------------------------------------------

  Korpus v1 zawierał błąd strukturalny:
  - 15 z 25 tekstów w klasie 'human' było wygenerowanych przez
    asystenta AI (proza oryginalna pisana na potrzeby testu)
  - Etykieta 'human' nie odpowiadała rzeczywistości
  - Ewaluacja mierzyła de facto: AI vs AI-udające-human
  - Wyniki v1 były artefaktem złego korpusu, nie rzeczywistą
    jakością modelu

  Rozwiązanie: zastąpić 100% tekstów klasy 'human' weryfikowalnymi
  źródłami z domeny publicznej (Wolne Lektury, wolnelektury.pl)

----------------------------------------------------------------
NOWY KORPUS v2 (corpus.csv)
----------------------------------------------------------------

  HUMAN (25 tekstów — wyłącznie Wolne Lektury):
  ┌─────────────────────────────┬──────────────────────────────────┬────┐
  │ Autor                       │ Dzieło                           │  n │
  ├─────────────────────────────┼──────────────────────────────────┼────┤
  │ Bolesław Prus               │ Lalka t.1, t.2 (1890)            │  4 │
  │                             │ Faraon t.1, t.2 (1897)           │  2 │
  │                             │ Placówka (1886)                  │  1 │
  │ Stefan Żeromski             │ Ludzie bezdomni t.1, t.2 (1900)  │  5 │
  │                             │ Przedwiośnie (1924)              │  1 │
  │ Henryk Sienkiewicz          │ Quo Vadis (1896)                 │  1 │
  │                             │ Ogniem i mieczem t.1 (1884)      │  1 │
  │                             │ Potop t.1, t.2, t.3 (1886)      │  3 │
  │                             │ Listy z Ameryki (1876)           │  1 │
  │ Władysław Reymont           │ Chłopi – Zima (1904)             │  1 │
  │                             │ Chłopi – Jesień (1904)           │  1 │
  │ Eliza Orzeszkowa            │ W klatce (1888)                  │  1 │
  │                             │ Gloria victis (1910)             │  1 │
  │ Maria Konopnicka            │ Wrażenia z podróży (1884)        │  1 │
  │ Stanisław Przybyszewski     │ Moi współcześni (1926)           │  1 │
  └─────────────────────────────┴──────────────────────────────────┴────┘
  Razem: 7 autorów, 14 dzieł, fragmenty po 300–600 znaków.
  Weryfikowalność: każdy tekst ma adres URL na wolnelektury.pl.

  AI (25 tekstów — wygenerowane przez Claude):
  Różne style i tematy: powrót do domu, dworzec, biblioteka,
  lekarz, wieś, schronisko, targ, zegarmistrz, ogród, pianino.
  Wspólna cecha: gładka narracja, regularna składnia, brak
  archaizmów i językowych osobliwości.

  Kolumna 'source' w CSV:
  Każdy tekst klasy 'human' ma wpisane źródło (autor, tytuł, rok).
  evaluate.py wypisuje to źródło przy błędnych klasyfikacjach.

----------------------------------------------------------------
WYNIKI EWALUACJI v2
----------------------------------------------------------------

  AUC-ROC:              0.9376   (poprzednio: 0.7936)
  Accuracy:             0.90     (poprzednio: 0.80)
  Precision:            0.8846   (poprzednio: 0.7273)
  Recall:               0.9200   (poprzednio: 0.96)
  F1:                   0.9020   (poprzednio: 0.8276)
  Optymalny próg:       37.043   (poprzednio: 38.45)

  Macierz pomyłek:
                   Pred: Human   Pred: AI
    True: Human       22            3     ← 3 fałszywe alarmy
    True: AI           2           23     ← 2 przeoczone

  Poprawa AUC: +0.144 (z 0.79 → 0.94)
  Interpretacja: AUC > 0.90 = "doskonała dyskryminacja"
  (Hosmer & Lemeshow, 2000)

----------------------------------------------------------------
ANALIZA BŁĘDÓW (materiał do pracy inżynierskiej)
----------------------------------------------------------------

  FAŁSZYWE ALARMY — human sklasyfikowane jako AI (3):

    1. Prus – Lalka t.2, Wokulski w pociągu          ppx = 28.26
       Przyczyna: krótkie zdania, narracja introspekcyjna,
       spokojny ton bez archaizmów. Psychologiczny opis stanu
       wewnętrznego — bliski stylowi AI.

    2. Reymont – Chłopi, Jesień, Boryna na miedzy    ppx = 29.19
       Przyczyna: prosta epiczna narracja 3. osoby,
       zdania opisowe bez dialektyzmu na początku fragmentu.

    3. Sienkiewicz – Potop t.2, Soroka i Kmicic      ppx = 36.46
       Przyczyna: dynamiczna narracja akcji, proste krótkie
       zdania, bliski granicy progu (36.46 vs 37.04).

  PRZEOCZENIA — AI sklasyfikowane jako human (2):

    4. ppx = 47.35 — tekst z narracyjnymi wtraceniami,
       refleksjami i złożoną składnią zdań wieloczłonowych.

    5. ppx = 37.04 — tekst z emocjonalnymi pauzami i
       nieregularnym rytmem zdań (tuż przy progu).

  WZORZEC BŁĘDÓW:
    System myli się na tekstach, gdzie:
    - Ludzki tekst ma prostą, regularną narrację epicką (Reymont, Potop)
    - Tekst AI ma nieregularną, emocjonalną składnię
    Wniosek: perplexity mierzy "regularność" stylu, nie
    "człowieczeństwo" — to ograniczenie metody, nie błąd modelu.
    Opisane w literaturze: Gehrmann et al. (2019), Ippolito et al. (2019).

----------------------------------------------------------------
ZAKTUALIZOWANE PROGI W ai_detector.py (v2)
----------------------------------------------------------------

  PERPLEXITY_AI_THRESHOLD    = 28.89  (poprzednio: 30.0)
  PERPLEXITY_HUMAN_THRESHOLD = 37.04  (poprzednio: 38.45)
  Strefa szara: 28.89 – 37.04

  Zmiana semantyczna:
    v1: strefa szara ~ 8 jednostek szerokości (30.0 – 38.45)
    v2: strefa szara ~ 8 jednostek szerokości (28.89 – 37.04)
    Szerokość podobna, ale oba końce przesunięte niżej —
    model jest "bardziej wymagający" wobec tekstów ludzkich.

----------------------------------------------------------------
ZAKTUALIZOWANY evaluate.py
----------------------------------------------------------------

  Nowe funkcjonalności:
  - Obsługa kolumny 'source' (opcjonalna)
  - Wypisuje źródło przy każdym błędnie sklasyfikowanym tekście
  - Na końcu podpowiada gotowe wartości progów do ai_detector.py
  - Wykres: krzywa ROC + histogram rozkładu perplexity

  Pliki wyjściowe po każdym uruchomieniu:
    evaluation_results.csv   — wyniki per tekst
    evaluation_summary.json  — podsumowanie (JSON)
    roc_curve.png            — wykres do pracy

----------------------------------------------------------------
STATUS PROJEKTU
----------------------------------------------------------------

  ✅ [1]  Setup środowiska (Python venv, Node.js)
  ✅ [2]  Stylometria + NLP (indeks LIX, analiza składni)
  ✅ [3]  Detekcja AI — model Polish GPT-2
  ✅ [4]  Kalibracja v1 (korpus n=50, AUC=0.79)
  ✅ [5]  Rekalibracja v2 (czysty korpus, AUC=0.94)
  ✅ [6]  API FastAPI + endpointy
  ✅ [7]  Upload pliku (.txt/.pdf/.docx)
  ✅ [8]  Frontend React (Analyze.jsx)
  ✅ [9]  Skrypt startowy (start.ps1)
  ⚠️ [10] Frontend — kod gotowy, NIE testowany end-to-end
  ❌ [11] Pytest — NIE uruchomione
  ❌ [12] Eksport raportu PDF/JSON z frontendu

----------------------------------------------------------------
CO DALEJ (ETAP 5)
----------------------------------------------------------------

  Priorytety:
  → Uruchomić aplikację przez start.ps1
  → Przetestować frontend end-to-end (paste + upload)
  → Uruchomić pytest (testy API)
  → Opcjonalnie: eksport raportu z wynikami analizy
  → Pisanie pracy: rozdział 4 (implementacja), rozdział 5 (testy)

  Materiały do pracy gotowe do wklejenia:
  → Tabela porównania metryk v1 vs v2
  → Tabela błędnych klasyfikacji z przyczynami
  → Wykres roc_curve.png
  → JSON z evaluation_summary.json (jako tabela w pracy)

----------------------------------------------------------------
TRANSKRYPT
----------------------------------------------------------------
  Poprzedni: /mnt/transcripts/2026-02-15-21-02-43-corpus-expansion-file-upload.txt
  Pliki:     corpus.csv, ai_detector.py, evaluate.py, start.ps1

================================================================
